---
toc:
  enable: true
  number: false
  max_depth: 3
title: 大文件排序
date: 2023-09-21 12:04:34
tags: 后端设计
categories: 后端设计
---

在一个大文件中有 100 亿个 32 位整数，乱序排列，要求找出中位数，内存限制为 512M

## 分析

100 亿个 32 位整数，全部读入内存需要 100 亿 * 4Byte = 40G

## 外部归并

1. 内存限制为 512M，可以分成 40G / 512M = 80 份。读取 100 亿个 32 位整数，对读取的整数对 80 取模，依次写入对应的文件中，这样就分成了 80 个 512M 的小文件

2、对这 80 个 512M 的小文件分别做快排，时间复杂度 O(NogN)

3、对这 80 个有序的 512M 的小文件进行外部归并排序，得到一个 100 亿个数字的有序序列，取第 50 亿大的数和第 50 亿零 1 大的数，将这两位数取平均值
